#!/usr/bin/env python3
import os
import sys

# Get the directory of this script
script_dir = os.path.dirname(os.path.realpath(__file__))
build_root = '@BUILD_ROOT@'
source_root = '@SOURCE_ROOT@'

# Set environment variables for GSettings schema
schema_dir = os.path.join(build_root, 'data', 'glib-2.0', 'schemas')
os.environ['GSETTINGS_SCHEMA_DIR'] = schema_dir

# Add the source directory to Python path
if source_root not in sys.path:
    sys.path.insert(0, source_root)

# Set environment variable for GResource
resource_path = os.path.join(build_root, 'src', '@PROJECT_NAME@.gresource')
if os.path.exists(resource_path):
    os.environ['G_RESOURCE_OVERLAYS'] = f'/com/jackgraddon/h2mmgui={build_root}/src'

# Set XDG_DATA_DIRS to find icons and other data
data_dir = os.path.join(build_root, 'data')
current_xdg_data_dirs = os.environ.get('XDG_DATA_DIRS', '/usr/local/share:/usr/share')
os.environ['XDG_DATA_DIRS'] = f"{data_dir}:{current_xdg_data_dirs}"

# Import and run the main module
from src.main import main
sys.exit(main())
